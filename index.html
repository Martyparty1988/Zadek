import React, { useState } from 'react';
import { Settings } from 'lucide-react';

const VILLA_DATA = {
  "Oh Yeah Vila": {
    color: "#ffb3b3",
    items: [
      { id: 1, name: "Budvar", priceCZK: 59, priceEUR: null, icon: "üç∫" },
      { id: 2, name: "Malibu", priceCZK: 99, priceEUR: null, icon: "ü••" },
      { id: 3, name: "Jack s colou", priceCZK: 99, priceEUR: null, icon: "ü•É" },
      { id: 4, name: "Moscow Mule", priceCZK: 99, priceEUR: null, icon: "üçπ" },
      { id: 5, name: "Gin-Tonic", priceCZK: 99, priceEUR: null, icon: "üç∏" },
      { id: 6, name: "Mojito", priceCZK: 99, priceEUR: null, icon: "üçÉ" },
      { id: 7, name: "Prosecco", priceCZK: 390, priceEUR: null, icon: "üçæ" },
      { id: 8, name: "Pivo sud 30 l", priceCZK: null, priceEUR: 125, icon: "üç∫" },
      { id: 9, name: "Pivo sud 50 l", priceCZK: null, priceEUR: 175, icon: "üç∫" },
      { id: 10, name: "Plyn", priceCZK: null, priceEUR: 12, icon: "‚õΩ" },
      { id: 11, name: "Gril", priceCZK: null, priceEUR: 20, icon: "üî•" }
    ]
  },
  "Amazing Pool Vila": {
    color: "#b3ffd9",
    items: [
      { id: 1, name: "Budvar", priceCZK: 59, priceEUR: null, icon: "üç∫" },
      { id: 2, name: "Malibu", priceCZK: 99, priceEUR: null, icon: "ü••" },
      { id: 3, name: "Jack s colou", priceCZK: 99, priceEUR: null, icon: "ü•É" },
      { id: 4, name: "Moscow Mule", priceCZK: 99, priceEUR: null, icon: "üçπ" },
      { id: 5, name: "Gin-Tonic", priceCZK: 99, priceEUR: null, icon: "üç∏" },
      { id: 6, name: "Mojito", priceCZK: 99, priceEUR: null, icon: "üçÉ" },
      { id: 7, name: "Coca-Cola", priceCZK: 32, priceEUR: null, icon: "ü•§" },
      { id: 8, name: "Sprite", priceCZK: 32, priceEUR: null, icon: "ü•§" },
      { id: 9, name: "Red Bull", priceCZK: 59, priceEUR: null, icon: "üßÉ" },
      { id: 10, name: "Prosecco", priceCZK: 390, priceEUR: null, icon: "üçæ" },
      { id: 11, name: "Pivo sud 30 l", priceCZK: null, priceEUR: 125, icon: "üç∫" },
      { id: 12, name: "Pivo sud 50 l", priceCZK: null, priceEUR: 175, icon: "üç∫" },
      { id: 13, name: "Plyn", priceCZK: null, priceEUR: 12, icon: "‚õΩ" },
      { id: 14, name: "Gril", priceCZK: null, priceEUR: 20, icon: "üî•" }
    ]
  },
  "Little Castle Vila": {
    color: "#ffd9b3",
    items: [
      { id: 1, name: "Budvar", priceCZK: 59, priceEUR: null, icon: "üç∫" },
      { id: 2, name: "Malibu", priceCZK: 99, priceEUR: null, icon: "ü••" },
      { id: 3, name: "Jack s colou", priceCZK: 99, priceEUR: null, icon: "ü•É" },
      { id: 4, name: "Moscow Mule", priceCZK: 99, priceEUR: null, icon: "üçπ" },
      { id: 5, name: "Gin-Tonic", priceCZK: 99, priceEUR: null, icon: "üç∏" },
      { id: 6, name: "Mojito", priceCZK: 99, priceEUR: null, icon: "üçÉ" },
      { id: 7, name: "Prosecco", priceCZK: 390, priceEUR: null, icon: "üçæ" },
      { id: 8, name: "Pivo sud 30 l", priceCZK: null, priceEUR: 125, icon: "üç∫" },
      { id: 9, name: "Pivo sud 50 l", priceCZK: null, priceEUR: 175, icon: "üç∫" },
      { id: 10, name: "Plyn", priceCZK: null, priceEUR: 12, icon: "‚õΩ" },
      { id: 11, name: "Gril", priceCZK: null, priceEUR: 20, icon: "üî•" }
    ]
  }
};

const App = () => {
  const [selectedVilla, setSelectedVilla] = useState("Oh Yeah Vila");
  const [cart, setCart] = useState([]);
  const [wellnessPrice, setWellnessPrice] = useState(0);
  const [guests, setGuests] = useState(1);
  const [nights, setNights] = useState(1);
  const [discountApplied, setDiscountApplied] = useState(false);
  const [currency, setCurrency] = useState("CZK");
  const [exchangeRate, setExchangeRate] = useState(25.5);
  const [paymentMethod, setPaymentMethod] = useState("Neplaceno");
  const [showInvoice, setShowInvoice] = useState(false);

  const currentVilla = VILLA_DATA[selectedVilla];

  const handleAddToCart = (item) => {
    setCart(prev => [...prev, item]);
  };

  const calculateTotal = () => {
    const subtotal = cart.reduce((acc, item) => {
      if (item.priceCZK && currency === "CZK") return acc + item.priceCZK;
      if (item.priceCZK && currency === "EUR") return acc + item.priceCZK / exchangeRate;
      if (item.priceEUR && currency === "CZK") return acc + item.priceEUR * exchangeRate;
      if (item.priceEUR && currency === "EUR") return acc + item.priceEUR;
      return acc;
    }, 0);

    const wellnessInCurrency = currency === "CZK" ? wellnessPrice * exchangeRate : Number(wellnessPrice);
    const totalBeforeDiscount = subtotal + wellnessInCurrency;
    const discountAmount = discountApplied ? totalBeforeDiscount * 0.1 : 0;
    const cityTax = guests * nights * 2;
    const cityTaxInCurrency = currency === "CZK" ? cityTax * exchangeRate : cityTax;

    return {
      subtotal,
      wellnessInCurrency,
      discountAmount,
      cityTaxInCurrency,
      total: totalBeforeDiscount - discountAmount + cityTaxInCurrency
    };
  };

  const getFormattedDate = () => {
    return new Date().toLocaleString('cs-CZ', {
      day: 'numeric',
      month: 'numeric',
      year: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });
  };

  if (showInvoice) {
    const calculations = calculateTotal();
    return (
      <div className="min-h-screen p-4" style={{ backgroundColor: currentVilla.color }}>
        <div className="bg-white rounded-lg p-4 shadow-lg">
          <h1 className="text-2xl font-bold mb-4">{selectedVilla}</h1>
          <p className="text-gray-600 mb-4">{getFormattedDate()}</p>
          
          <h2 className="text-xl font-semibold mb-2">Polo≈æky:</h2>
          <ul className="space-y-2 mb-4">
            {cart.map((item, index) => (
              <li key={index} className="flex justify-between">
                <span>{item.icon} {item.name}</span>
                <span>{item.priceCZK ? `${item.priceCZK} Kƒç` : `${item.priceEUR} ‚Ç¨`}</span>
              </li>
            ))}
            {wellnessPrice > 0 && (
              <li className="flex justify-between">
                <span>üíÜ‚Äç‚ôÇÔ∏è Wellness</span>
                <span>{wellnessPrice} ‚Ç¨</span>
              </li>
            )}
          </ul>

          <div className="border-t pt-2 mb-4">
            <p className="flex justify-between">
              <span>City Tax ({guests} host≈Ø √ó {nights} noc√≠ √ó 2‚Ç¨)</span>
              <span>{calculations.cityTaxInCurrency.toFixed(2)} {currency}</span>
            </p>
            {discountApplied && (
              <p className="flex justify-between text-red-600">
                <span>Sleva 10%</span>
                <span>-{calculations.discountAmount.toFixed(2)} {currency}</span>
              </p>
            )}
          </div>

          <div className="border-t pt-2">
            <p className="text-xl font-bold flex justify-between">
              <span>Celkem:</span>
              <span>{calculations.total.toFixed(2)} {currency}</span>
            </p>
            <p className="text-gray-600 mt-2">Platba: {paymentMethod}</p>
          </div>

          <button
            onClick={() => {
              setShowInvoice(false);
              setCart([]);
              setWellnessPrice(0);
              setGuests(1);
              setNights(1);
              setDiscountApplied(false);
              setPaymentMethod("Neplaceno");
            }}
            className="w-full mt-6 bg-blue-500 text-white py-3 rounded-lg"
          >
            Nov√° objedn√°vka
          </button>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen" style={{ backgroundColor: currentVilla.color }}>
      <div className="p-4">
        <div className="flex items-center gap-2 mb-4">
          <select
            value={selectedVilla}
            onChange={(e) => setSelectedVilla(e.target.value)}
            className="flex-1 p-2 rounded-lg text-lg"
          >
            {Object.keys(VILLA_DATA).map(villa => (
              <option key={villa} value={villa}>{villa}</option>
            ))}
          </select>
          <select
            value={currency}
            onChange={(e) => setCurrency(e.target.value)}
            className="p-2 rounded-lg"
          >
            <option value="CZK">CZK</option>
            <option value="EUR">EUR</option>
          </select>
          <button
            onClick={() => {
              const userRate = prompt("Zadejte kurz 1 ‚Ç¨ v CZK:", exchangeRate);
              if (userRate && !isNaN(userRate)) {
                setExchangeRate(Number(userRate));
              }
            }}
            className="p-2 rounded-lg bg-gray-100"
          >
            <Settings className="w-5 h-5" />
          </button>
        </div>

        <div className="space-y-2 mb-4">
          <div className="flex gap-2">
            <input
              type="number"
              min="1"
              value={guests}
              onChange={(e) => setGuests(Number(e.target.value))}
              placeholder="Host√©"
              className="flex-1 p-2 rounded-lg"
            />
            <input
              type="number"
              min="1"
              value={nights}
              onChange={(e) => setNights(Number(e.target.value))}
              placeholder="Noci"
              className="flex-1 p-2 rounded-lg"
            />
          </div>
          <input
            type="number"
            value={wellnessPrice}
            onChange={(e) => setWellnessPrice(Number(e.target.value))}
            placeholder="Wellness (EUR)"
            className="w-full p-2 rounded-lg"
          />
          <label className="flex items-center gap-2 bg-white p-2 rounded-lg">
            <input
              type="checkbox"
              checked={discountApplied}
              onChange={(e) => setDiscountApplied(e.target.checked)}
            />
            <span>Sleva 10%</span>
          </label>
        </div>

        <div className="grid grid-cols-2 gap-2 mb-4">
          {currentVilla.items.map((item) => (
            <button
              key={item.id}
              onClick={() => handleAddToCart(item)}
              className="bg-white p-4 rounded-lg text-center shadow active:bg-gray-50"
            >
              <div className="text-3xl mb-1">{item.icon}</div>
              <div className="font-medium">{item.name}</div>
              <div className="text-gray-600">
                {item.priceCZK ? `${item.priceCZK} Kƒç` : `${item.priceEUR} ‚Ç¨`}
              </div>
            </button>
          ))}
        </div>

        {cart.length > 0 && (
          <div className="fixed bottom-0 left-0 right-0 bg-white p-4 shadow-lg">
            <div className="mb-2">
              <select
                value={paymentMethod}
                onChange={(e) => setPaymentMethod(e.target.value)}
                className="w-full p-2 rounded-lg mb-2"
              >
                <option value="Neplaceno">Neplaceno</option>
                <option value="Hotovƒõ">Hotovƒõ</option>
                <option value="Kartou">Kartou</

<option value="Hotovƒõ">Hotovƒõ</option>
                <option value="Kartou">Kartou</option>
              </select>
            </div>
            <div className="flex justify-between items-center mb-2">
              <span>Celkem: {calculateTotal().total.toFixed(2)} {currency}</span>
              <button
                onClick={() => setShowInvoice(true)}
                className="bg-green-500 text-white px-6 py-2 rounded-lg"
              >
                Faktura
              </button>
            </div>
            <div className="text-sm text-gray-600">
              {cart.length} polo≈æek v ko≈°√≠ku
            </div>
          </div>
        )}
      </div>
    </div>
  );
};

export default App;
```

A zde je CSS k√≥d, kter√Ω by mƒõl b√Ωt v souboru styles.css:

```css
@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  margin: 0;
  padding: 0;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, 
    "Helvetica Neue", Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Optimalizace pro iPhone */
@supports (-webkit-touch-callout: none) {
  .min-h-screen {
    min-height: -webkit-fill-available;
  }
}

/* Zabr√°nƒõn√≠ zv√Ωraz≈àov√°n√≠ p≈ôi tapnut√≠ na iOS */
* {
  -webkit-tap-highlight-color: transparent;
}

/* Lep≈°√≠ scrollov√°n√≠ na iOS */
.overflow-scroll {
  -webkit-overflow-scrolling: touch;
}

/* Stylov√°n√≠ pro iOS input fields */
input[type="number"],
select {
  -webkit-appearance: none;
  appearance: none;
  border: 1px solid #e2e8f0;
}

/* Odstranƒõn√≠ ≈°ipek z ƒç√≠seln√Ωch input≈Ø */
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

/* P≈ôizp≈Øsoben√≠ velikosti pro men≈°√≠ displeje */
@media (max-width: 390px) {
  .text-3xl {
    font-size: 1.5rem;
  }
  .p-4 {
    padding: 0.75rem;
  }
  .gap-2 {
    gap: 0.375rem;
  }
}